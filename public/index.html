<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Golf Score Tracker</title>
  <style>
    :root{ --bg:#0f172a; --panel:#111827; --muted:#1f2937; --accent:#22c55e; --text:#e5e7eb; --subtle:#9ca3af; --danger:#ef4444; --warn:#f59e0b; --shadow:0 10px 30px rgba(0,0,0,.35); --radius:16px; }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans","Helvetica Neue","Arial"}
    header{position:sticky;top:0;background:linear-gradient(180deg, rgba(17,24,39,.98), rgba(17,24,39,.85));backdrop-filter: blur(8px);z-index:10;border-bottom:1px solid rgba(255,255,255,.06)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand h1{font-size:20px;margin:0;font-weight:700}
    nav{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .tab{appearance:none;border:1px solid rgba(255,255,255,.08);background:#0b1220;color:var(--text);padding:10px 14px;border-radius:999px;cursor:pointer;transition:.2s}
    .tab.active{background:var(--accent);border-color:transparent;color:#04120a;font-weight:700}
    main{padding:24px 0}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{grid-column:span 12;background:var(--panel);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card .hd{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between}
    .card .bd{padding:16px 20px}
    @media(min-width:1100px){ .layout{display:grid;grid-template-columns:240px 1fr; gap:16px;} }
    table{width:100%;border-collapse:separate;border-spacing:0}
    th,td{padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left}
    thead th{font-size:12px;text-transform:uppercase;letter-spacing:.08em;color:var(--subtle)}
    tbody tr:hover{background:rgba(255,255,255,.03)}
    .muted{color:var(--subtle)} .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;font-size:12px}
    .btn{appearance:none;background:var(--accent);border:none;color:#04120a;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(34,197,94,.25);transition:transform .05s}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{background:#0b1220;color:var(--text);border:1px solid rgba(255,255,255,.12);box-shadow:none}
    .row{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
    .field{display:flex;flex-direction:column;gap:6px}
    .field input,.field select{background:#0b1220;border:1px solid rgba(255,255,255,.1);color:var(--text);padding:10px 12px;border-radius:10px;outline:none}
    .list{display:grid;gap:8px} .milestone{padding:10px 12px;border:1px dashed rgba(255,255,255,.14);border-radius:10px;background:#0b1220}
    details.round{border:1px solid rgba(255,255,255,.12);border-radius:12px;background:#0b1220} details.round summary{cursor:pointer;padding:10px 12px}
    .hint{font-size:12px;color:var(--subtle)} .good{color:#86efac} .bad{color:#fca5a5}
    .sidemenu{position:sticky; top:90px; display:flex; flex-direction:column; gap:8px}
    .sidemenu .item{display:flex; gap:10px; align-items:center; padding:10px 12px; border-radius:12px; background:#0b1220; border:1px solid rgba(255,255,255,.08); cursor:pointer}
    .sidemenu .item.active{background:var(--accent); color:#04120a; border-color:transparent; font-weight:700}
    .section{display:none}
    .section.active{display:block}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 4a1 1 0 0 0-1 1v14a1 1 0 0 0 1.447.894l10-5A1 1 0 0 0 18 13V6a1 1 0 0 0-.553-.894l-10-5A1 1 0 0 0 7 1v3z" fill="currentColor" opacity=".22"/>
          <circle cx="18.5" cy="18.5" r="3.5" stroke="currentColor" stroke-width="1.5"/>
          <path d="M18.5 16v2.25H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <h1>Golf Score Tracker</h1>
      </div>
      <nav id="nav"></nav>
    </div>
  </header>

  <main class="wrap">
    <!-- LOGIN PAGE -->
    <section id="page-login" class="page">
      <div class="card" style="max-width:560px;margin:40px auto;">
        <div class="hd"><h2>Sign in</h2></div>
        <div class="bd">
          <div class="row">
            <div class="field" style="flex:1"><label>Username</label><input id="login-username" type="text" autocomplete="username"></div>
            <div class="field" style="flex:1"><label>Password</label><input id="login-password" type="password" autocomplete="current-password"></div>
          </div>
          <div style="height:12px"></div>
          <button class="btn" id="login-btn">Sign in</button>
          <span id="login-msg" class="hint" style="margin-left:12px"></span>
        </div>
      </div>
    </section>

    <!-- HOME -->
    <section id="page-home" class="page" hidden>
      <div class="grid">
        <div class="card col-6">
          <div class="hd"><h2>Who played last</h2><span class="pill">Latest round per player</span></div>
          <div class="bd">
            <table id="home-last-table">
              <thead><tr><th>Player</th><th>Last played</th><th>Last score</th><th>Course</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="card col-6">
          <div class="hd"><h2>Milestones</h2><span class="pill">Most recent → oldest</span></div>
          <div class="bd">
            <div id="milestones" class="list"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- PERSONAL STATS -->
    <section id="page-person" class="page" hidden>
      <div class="card">
        <div class="hd">
          <h2>Personal stats</h2>
          <div class="row" style="max-width:540px">
            <div class="field"><label for="person-select">Select player</label>
              <select id="person-select"></select>
            </div>
          </div>
        </div>
        <div class="bd">
          <div id="person-stats" class="grid">
            <div class="col-3"><div class="field"><label>Average score</label><div id="ps-avg" class="pill">—</div></div></div>
            <div class="col-3"><div class="field"><label>Most played course</label><div id="ps-most" class="pill">—</div></div></div>
            <div class="col-3"><div class="field"><label>Best score</label><div id="ps-best" class="pill">—</div></div></div>
            <div class="col-3"><div class="field"><label>Handicap Index</label><div id="ps-hcp" class="pill">—</div><div id="ps-hcp-hint" class="hint"></div></div></div>
          </div>

          <div style="height:16px"></div>
          <div class="card">
            <div class="hd"><h2>Net score over time</h2><span class="pill">Gross − handicap-at-time</span></div>
            <div class="bd"><canvas id="ps-chart" height="120"></canvas></div>
          </div>

          <div style="height:16px"></div>
          <div class="field">
            <label>Rounds</label>
            <div id="person-rounds" class="list"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- COURSE STATS -->
    <section id="page-course" class="page" hidden>
      <div class="card">
        <div class="hd">
          <h2>Course stats</h2>
          <div class="row" style="max-width:720px">
            <div class="field"><label for="course-select">Select course</label>
              <select id="course-select"></select>
            </div>
          </div>
        </div>
        <div class="bd">
          <div id="course-stats" class="grid">
            <div class="col-4"><div class="field"><label>Course name</label><div id="cs-name" class="pill">—</div></div></div>
            <div class="col-4"><div class="field"><label>Location</label><div id="cs-loc" class="pill">—</div></div></div>
            <div class="col-4"><div class="field"><label>Course par</label><div id="cs-par" class="pill">—</div></div></div>
            <div class="col-4"><div class="field"><label>Average score at course</label><div id="cs-avg" class="pill">—</div></div></div>
            <div class="col-4"><div class="field"><label>Best score at course</label><div id="cs-best" class="pill">—</div></div></div>
            <div class="col-4"><div class="field"><label>Course rating</label><div id="cs-rating" class="pill">—</div></div></div>
            <div class="col-6"><div class="field"><label>Easiest hole</label><div id="cs-easiest" class="pill">—</div></div></div>
            <div class="col-6"><div class="field"><label>Hardest hole</label><div id="cs-hardest" class="pill">—</div></div></div>
            <div class="col-6"><div class="field"><label>Best player at course</label><div id="cs-bestplayer" class="pill">—</div></div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- LOG SCORE -->
    <section id="page-log" class="page" hidden>
      <div class="card">
        <div class="hd"><h2>Log a score</h2></div>
        <div class="bd">
          <div class="row" id="log-player-row">
            <div class="field"><label>Player</label><select id="log-player"></select></div>
            <div class="field"><label>Course</label><select id="log-course"></select></div>
          </div>
          <div style="height:8px"></div>
          <div class="row">
            <div class="field"><label>Date — Day</label><select id="log-day"></select></div>
            <div class="field"><label>Month</label><select id="log-month"></select></div>
            <div class="field"><label>Year</label><select id="log-year"></select></div>
          </div>
          <div style="height:12px"></div>
          <div id="log-table-wrap"></div>
          <div style="height:12px"></div>
          <div class="grid">
            <div class="col-4"><div class="field"><label>Computed total</label><input id="log-total" type="number" readonly></div></div>
            <div class="col-4"><div class="field"><label>Adjusted Gross Score (optional)</label><input id="log-ags" type="number" step="1" placeholder="Leave blank to use total"/></div></div>
            <div class="col-4"><div class="field"><label>Handicap Differential</label><input id="log-diff" type="text" readonly></div></div>
          </div>
          <div class="hint">Differential = ((Adjusted Gross Score − Course Rating) × 113) ÷ Slope Rating</div>
          <div style="height:14px"></div>
          <button class="btn" id="log-save">Save round</button>
          <span id="log-msg" class="hint" style="margin-left:12px"></span>
        </div>
      </div>
    </section>

    <!-- ADMIN -->
    <section id="page-admin" class="page" hidden>
      <div class="layout">
        <aside class="sidemenu">
          <div class="item" data-sec="users">User List</div>
          <div class="item" data-sec="courses">Create / Edit Course</div>
          <div class="item" data-sec="profiles">Create Profile / Log Score</div>
        </aside>
        <div>
          <div class="card">
            <div class="hd"><h2>Admin</h2><span class="pill" id="admin-badge"></span></div>
            <div class="bd">
              <div id="sec-users" class="section"></div>
              <div id="sec-courses" class="section"></div>
              <div id="sec-profiles" class="section"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="/app.js"></script>
</body>
</html>
